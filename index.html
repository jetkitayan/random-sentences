<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Random English Sentences</title>
<style>
body {
  font-family: sans-serif;
  margin: 0;
  padding: 0 0 160px 0; /* 下だけ余白（ボタン分） */
  background-color: #fafafa;
}

#content {
  margin-top: 20px;   /* ← 80pxから縮める */
  padding-left: 40px;
  max-width: 900px;
}

.count-label,
#sentence-jp,
#sentence-en {
  margin: 2px 0;
  line-height: 1.2;
  font-size: 28px;
  color: #000;
}

.count-label,
#sentence-jp,
#sentence-en,
#sentence-jp div,
#sentence-en div {
  margin: 32px 0;       /* ← 今より少し余裕を残す（完全に0にしない） */
  line-height: 1.2;    /* 行間はややタイトに */
}

/* 🔹 ボタンエリアは下固定 */
#button-area {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: #fff;
  border-top: 1px solid #ddd;
  padding: 20px 0;
  box-shadow: 0 -2px 6px rgba(0,0,0,0.1);
  text-align: center;
}

button {
  padding: 15px 30px;
  font-size: 22px;
  margin: 10px;
  border-radius: 10px;
}
</style>
</head>
<body>

<div id="content">
  <div id="sentence-jp">Press "Show Random" to start</div>
  <div id="sentence-en"></div>
</div>

<div id="button-area">
  <button id="showBtn">Show Random</button>
  <button id="okBtn" disabled>OK</button>
  <button id="resetBtn">Reset</button>
</div>

<thead>
  <tr>
    <th>日本語</th>
    <th>英語</th>
    <th>YES押下</th>     <!-- ✅ -->
    <th>表示回数</th>     <!-- ✅ -->
  </tr>
</thead>
  
<script>
let allSentences = [];
let shownCounts = JSON.parse(localStorage.getItem("shownCounts")) || {};
let remaining = JSON.parse(localStorage.getItem("remaining")) || [];
let currentSentence = null;

fetch("sentences.json")
  .then(response => response.json())
  .then(data => {
    allSentences = data;
    if (remaining.length === 0) remaining = allSentences.map(s => s.en);
  });

function showRandom() {
  if (remaining.length === 0) {
    document.getElementById("sentence-jp").innerText = "すべての英文を表示しました！";
    document.getElementById("sentence-en").innerText = "";
    document.getElementById("showBtn").disabled = true;
    document.getElementById("okBtn").disabled = true;
    return;
  }

  const en = remaining[Math.floor(Math.random() * remaining.length)];
  currentSentence = allSentences.find(s => s.en === en);

  if (!shownCounts[en]) shownCounts[en] = 0;
  shownCounts[en]++;
  localStorage.setItem("shownCounts", JSON.stringify(shownCounts));

  const totalShown = Object.values(shownCounts).reduce((a,b)=>a+b,0);

  // ✅ 上段に「x回目」と「Total Shown」を横並びで表示
  // ✅ 上段に「x回目」と「Total Shown」を1行で表示
document.getElementById("sentence-jp").innerHTML = `
  <div class="top-meta">${shownCounts[en]}回目 （総回数: ${totalShown}）</div>
  <div>${currentSentence.jp}</div>
`;
document.getElementById("sentence-en").innerText = currentSentence.en;
document.getElementById("okBtn").disabled = false;
}
  
function confirmSentence() {
  if (!currentSentence) return;
  remaining = remaining.filter(s => s !== currentSentence.en);
  localStorage.setItem("remaining", JSON.stringify(remaining));

  document.getElementById("sentence-jp").innerText = "Press 'Show Random' again";
  document.getElementById("sentence-en").innerText = "";
  document.getElementById("okBtn").disabled = true;

  if (remaining.length === 0) {
    document.getElementById("showBtn").disabled = true;
  }
}

function resetData() {
  if (confirm("Reset all data?")) {
    localStorage.removeItem("shownCounts");
    localStorage.removeItem("remaining");
    shownCounts = {};
    remaining = allSentences.map(s => s.en);
    currentSentence = null;
    document.getElementById("sentence-jp").innerText = "Press 'Show Random' to start";
    document.getElementById("sentence-en").innerText = "";
    document.getElementById("showBtn").disabled = false;
  }
}

function showStats() {
  let tbody = document.getElementById("statsBody");
  tbody.innerHTML = "";

  allSentences.forEach(s => {
    const count = shownCounts[s.en] || 0;
    const yes = remaining.includes(s.en) ? "❌" : "✅";
    const row = `
      <tr>
        <td>${s.jp}</td>
        <td>${s.en}</td>
        <td style="text-align:center;">${yes}</td>       <!-- ✅ YES押下を先に -->
        <td style="text-align:center;">${count}</td>     <!-- ✅ 表示回数を後に -->
      </tr>`;
    tbody.innerHTML += row;
  });

  document.getElementById("statsArea").style.display = "block";
}

document.getElementById("showBtn").onclick = showRandom;
document.getElementById("okBtn").onclick = confirmSentence;
document.getElementById("resetBtn").onclick = resetData;
</script>

</body>
</html>






















